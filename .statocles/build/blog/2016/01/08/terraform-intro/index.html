<!DOCTYPE html>
<html lang="en"> 
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" />
        <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
        <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
        <link rel="stylesheet" href="/theme/css/readability-bootstrap.min.css" />
        <!--<link rel="stylesheet" href="/theme/css/statocles-bootstrap.css" />-->
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
        <title>Introduction to Terraform - Neil H. Watson</title>
        <meta name="generator" content="Statocles 0.093" />
        
        <link rel="stylesheet" href="/theme/plugin/highlight/default.css" type="text/css" />

        <!-- For source highlighting -->
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/default.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

    </head>
    <body>
        <header>
            <nav class="navbar navbar-default navbar-static-top" role="navigation">
                <div class="container">
                <!-- Brand and toggle get grouped for better mobile display -->
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#top-navbar-collapse-1">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="/">Neil H. Watson</a>
                    </div>
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse" id="top-navbar-collapse-1">
                        <ul class="nav navbar-nav">
                            <li><a href="/page/about">About me</a></li>
                            <li><a href="/static/resume_neil_h_watson.pdf">Resume</a></li>
                            <li><a href="/page/projects">Projects</a></li>
                            <li><a href="/page/evolvethinking">UPDATE: EvolveThinking</a></li>
                        </ul>
                        
                    </div>
                </div>
            </nav>
            
        </header>
        <div class="main container">
            <div class="row">

    <div class="col-md-9">
        <main>
            <header>
                <h1>Introduction to Terraform</h1>
                <p class="tags">Tags:
                    <a href="/blog/tag/terraform/" rel="tag">terraform</a>
                    <a href="/blog/tag/cloud/" rel="tag">cloud</a>
                    <a href="/blog/tag/configuration-management/" rel="tag">configuration management</a>
                </p>

                <aside>
                    <p><time datetime="2016-01-08">
                        Posted on 2016-01-08
                    </time>
                    </p>
                </aside>


            </header>
            <section id="section-1">
                <p><a href="https://terraform.io/"><img style='float:right' alt='terraform logo' width='120px' src='https://raw.githubusercontent.com/hashicorp/terraform-website/master/content//source/assets/images/og-image.png' ></a></p>

<p><a href="https://terraform.io/">Terraform</a> allows you to manage your AWS, and other
cloud infrastructure, the same way you would manage servers using configuration
management products like CFEngine or Puppet. Terraform is idempotent and
convergent so only required changes are applied.</p>

            </section>
            <section id="section-2">
                <p>I whipped up this example to build:</p>

<ol>
<li>An SSH public key to be installed on the created EC2 instance.</li>
<li>A security group allowing HTTP and HTTPS.</li>
<li>A security group allowing SSH.</li>
<li>A tc2.micro EC2 instance with the above applied to it.</li>
</ol>

<p>The 'provider' part of the file indicates to terraform to use its AWS provider
with the given credentials. If you know AWS at all the terraform code is not
hard to follow.</p>

<p>Create a file in your current directory called demo.tf. When you run terrafrom
it searches the current directory for .tf files and reads them according to
your instructions. For example:</p>

<ul>
<li><code>Terraform plan</code> will report what must be done, but perform no changes.</li>
<li><code>Terraform apply</code> will make the changes shown above.</li>
<li><code>Terraform show</code> will show the current state.</li>
<li><code>Terraform destroy</code> will <em>destroy everything that is defined</em>.</li>
</ul>

<p>Note that there seems to be a built in order in which terraform runs that is
not related to the order of the file. This is much like normal ordering in
CFEngine. For example, when I run this code with nothing configured in AWS, it
will try to build the server instance first, but fails because the groups and keys
are not yet defined. But the groups and keys will be created next, so,
run terraform a second time and it will converge, by creating just the instance
while leaving the already existing groups and keys as they are.</p>

<pre><code class="hljs">provider <span class="hljs-string">"aws"</span> {
   access_key = <span class="hljs-string">"your_key_here"</span>
   secret_key = <span class="hljs-string">"your_secret_here"</span>
   region = <span class="hljs-string">"us-east-1"</span>
}

resource <span class="hljs-string">"aws_key_pair"</span> <span class="hljs-string">"neptune"</span> {
   key_name = <span class="hljs-string">"neptune"</span>
   public_key = <span class="hljs-string">"ssh-rsa AAA removed for brevity 1XCr neil@neptune"</span>
}

resource <span class="hljs-string">"aws_security_group"</span> <span class="hljs-string">"ssh"</span> {
   <span class="hljs-type">name</span> = <span class="hljs-string">"ssh"</span>
   <span class="hljs-type">description</span> = <span class="hljs-string">"Allow inbound ssh"</span>
   ingress = {
      from_port = 0
      to_port   = <span class="hljs-number">22</span>
      <span class="hljs-type">protocol</span>  = <span class="hljs-string">"tcp"</span>
      cidr_blocks = [ <span class="hljs-string">"0.0.0.0/0"</span> ]
   }
}

resource <span class="hljs-string">"aws_security_group"</span> <span class="hljs-string">"http"</span> {
   <span class="hljs-type">name</span> = <span class="hljs-string">"http"</span>
   <span class="hljs-type">description</span> = <span class="hljs-string">"Allow inbound http"</span>
   ingress = {
      from_port = 0
      to_port   = <span class="hljs-number">80</span> 
      <span class="hljs-type">protocol</span>  = <span class="hljs-string">"tcp"</span>
      cidr_blocks = [ <span class="hljs-string">"0.0.0.0/0"</span> ]
   }
   egress = {
      from_port = 0
      to_port   = <span class="hljs-number">80</span>
      <span class="hljs-type">protocol</span>  = <span class="hljs-string">"tcp"</span>
      cidr_blocks = [ <span class="hljs-string">"0.0.0.0/0"</span> ]
   }
   egress = {
      from_port = 0
      to_port   = 443
      <span class="hljs-type">protocol</span>  = <span class="hljs-string">"tcp"</span>
      cidr_blocks = [ <span class="hljs-string">"0.0.0.0/0"</span> ]
   }
}

resource <span class="hljs-string">"aws_instance"</span> <span class="hljs-string">"tfdemo"</span> {

    ami = <span class="hljs-string">"ami-60b6c60a"</span>
    instance_type = <span class="hljs-string">"t2.micro"</span>

   key_name = <span class="hljs-string">"neptune"</span>
   security_groups = [ <span class="hljs-string">"ssh"</span>, <span class="hljs-string">"http"</span>, <span class="hljs-string">"default"</span> ]
}
</code></pre>

<p>I've shown only a small portion of what terraform can do. Most
<a href="https://terraform.io/docs/providers/aws/index.html">things</a> you might want to
do in AWS can be defined in Terraform and not just AWS. Terraform also supports
Cloudflare, DigitalOcean, Docker, Google Cloud, vSphere, Azure, and
<a href="https://terraform.io/docs/providers/index.html">more</a>.</p>

            </section>
        </main>


    </div>

    <div class="col-md-3">
        <iframe src="https://duckduckgo.com/search.html?site=watson-wilson.ca&prefill=Search DuckDuckGo" style="overflow:hidden;margin:0;padding:0;width:350px;height:40px;" frameborder="0"></iframe>

        <nav id="tags">
            <h1>Tags</h1>
            <ul class="list-inline">
                <li><a href="/blog/tag/ansible/">ansible</a></li>
                <li><a href="/blog/tag/anti-virus/">anti-virus</a></li>
                <li><a href="/blog/tag/apt/">apt</a></li>
                <li><a href="/blog/tag/asg/">asg</a></li>
                <li><a href="/blog/tag/autoscaling/">autoscaling</a></li>
                <li><a href="/blog/tag/aws/">AWS</a></li>
                <li><a href="/blog/tag/azure/">azure</a></li>
                <li><a href="/blog/tag/backup/">backup</a></li>
                <li><a href="/blog/tag/best-practices/">best practices</a></li>
                <li><a href="/blog/tag/bitbucket/">bitbucket</a></li>
                <li><a href="/blog/tag/bosh/">bosh</a></li>
                <li><a href="/blog/tag/cfengine/">cfengine</a></li>
                <li><a href="/blog/tag/cfengine-cookbook/">cfengine cookbook</a></li>
                <li><a href="/blog/tag/cheatsheet/">cheatsheet</a></li>
                <li><a href="/blog/tag/cli/">cli</a></li>
                <li><a href="/blog/tag/cloud/">cloud</a></li>
                <li><a href="/blog/tag/cloud-foundry/">cloud foundry</a></li>
                <li><a href="/blog/tag/cluster/">cluster</a></li>
                <li><a href="/blog/tag/conferences/">conferences</a></li>
                <li><a href="/blog/tag/configuration-management/">configuration management</a></li>
                <li><a href="/blog/tag/containers/">containers</a></li>
                <li><a href="/blog/tag/continuous-integration/">continuous integration</a></li>
                <li><a href="/blog/tag/cron/">cron</a></li>
                <li><a href="/blog/tag/debian/">debian</a></li>
                <li><a href="/blog/tag/delta-reporting/">delta reporting</a></li>
                <li><a href="/blog/tag/devops/">devops</a></li>
                <li><a href="/blog/tag/dns/">dns</a></li>
                <li><a href="/blog/tag/docker/">docker</a></li>
                <li><a href="/blog/tag/dr/">dr</a></li>
                <li><a href="/blog/tag/efl/">EFL</a></li>
                <li><a href="/blog/tag/github/">github</a></li>
                <li><a href="/blog/tag/heartbeat/">heartbeat</a></li>
                <li><a href="/blog/tag/high-availability/">high availability</a></li>
                <li><a href="/blog/tag/infosec/">infosec</a></li>
                <li><a href="/blog/tag/ipv6/">ipv6</a></li>
                <li><a href="/blog/tag/irc/">irc</a></li>
                <li><a href="/blog/tag/iscsi/">iscsi</a></li>
                <li><a href="/blog/tag/jekyll/">jekyll</a></li>
                <li><a href="/blog/tag/jq/">jq</a></li>
                <li><a href="/blog/tag/json/">json</a></li>
                <li><a href="/blog/tag/kickstart/">kickstart</a></li>
                <li><a href="/blog/tag/kvm/">kvm</a></li>
                <li><a href="/blog/tag/linux/">linux</a></li>
                <li><a href="/blog/tag/markdown/">markdown</a></li>
                <li><a href="/blog/tag/monitoring/">monitoring</a></li>
                <li><a href="/blog/tag/multipathd/">multipathd</a></li>
                <li><a href="/blog/tag/mustache/">mustache</a></li>
                <li><a href="/blog/tag/networking/">networking</a></li>
                <li><a href="/blog/tag/opennms/">opennms</a></li>
                <li><a href="/blog/tag/opensource/">opensource</a></li>
                <li><a href="/blog/tag/oracle/">oracle</a></li>
                <li><a href="/blog/tag/orchestration/">orchestration</a></li>
                <li><a href="/blog/tag/patching/">patching</a></li>
                <li><a href="/blog/tag/pcre/">pcre</a></li>
                <li><a href="/blog/tag/perl/">perl</a></li>
                <li><a href="/blog/tag/posix/">posix</a></li>
                <li><a href="/blog/tag/programming/">programming</a></li>
                <li><a href="/blog/tag/provisioning/">provisioning</a></li>
                <li><a href="/blog/tag/python/">python</a></li>
                <li><a href="/blog/tag/red-hat/">red hat</a></li>
                <li><a href="/blog/tag/redhat/">redhat</a></li>
                <li><a href="/blog/tag/regex/">regex</a></li>
                <li><a href="/blog/tag/rhev/">rhev</a></li>
                <li><a href="/blog/tag/ruby/">ruby</a></li>
                <li><a href="/blog/tag/san/">san</a></li>
                <li><a href="/blog/tag/satellite/">satellite</a></li>
                <li><a href="/blog/tag/scripting/">scripting</a></li>
                <li><a href="/blog/tag/security/">security</a></li>
                <li><a href="/blog/tag/serverspec/">serverspec</a></li>
                <li><a href="/blog/tag/shell/">shell</a></li>
                <li><a href="/blog/tag/slaac/">slaac</a></li>
                <li><a href="/blog/tag/software-testing/">software testing</a></li>
                <li><a href="/blog/tag/solaris/">solaris</a></li>
                <li><a href="/blog/tag/spacewalk/">spacewalk</a></li>
                <li><a href="/blog/tag/ssh/">ssh</a></li>
                <li><a href="/blog/tag/statocles/">statocles</a></li>
                <li><a href="/blog/tag/subversion/">subversion</a></li>
                <li><a href="/blog/tag/sun/">sun</a></li>
                <li><a href="/blog/tag/support/">support</a></li>
                <li><a href="/blog/tag/svn/">svn</a></li>
                <li><a href="/blog/tag/sysadmin/">sysadmin</a></li>
                <li><a href="/blog/tag/sysctl/">sysctl</a></li>
                <li><a href="/blog/tag/terraform/">terraform</a></li>
                <li><a href="/blog/tag/virus/">virus</a></li>
                <li><a href="/blog/tag/vitualization/">vitualization</a></li>
                <li><a href="/blog/tag/website/">website</a></li>
            </ul>
        </nav>
    </div>

</div>

<div class='row'>
   <div class='col-md-1'>
       <img atl='Neil Watson' src='https://gravatar.com/avatar/1f0969599955a953e592034929ed7a23' >
   </div>

       <div class='col-md-1'>
            <!-- reddit this -->
            <a href="//www.reddit.com/submit" onclick="window.location = '//www.reddit.com/submit?url=' + encodeURIComponent(window.location); return false"><img src="//www.redditstatic.com/spreddit7.gif" alt="submit to reddit" border="0" /></a>
       </div>

       <div class='col-md-1'>
          <!-- Tweet this -->
          <a href="https://twitter.com/share" class="twitter-share-button" data-via="neil_h_watson" data-count="none">Tweet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
       </div>

       <div class='col-md-1'>
          <!-- follow me on twitter -->
          <a href="https://twitter.com/neil_h_watson" class="twitter-follow-button" data-show-count="false" data-show-screen-name="false">Follow @neil_h_watson</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
        </div>

       <div class='col-md-1'>
           <!-- follw me on github -->
            <a aria-label="Follow @neilhwatson on GitHub" data-style="mega" href="https://github.com/neilhwatson" class="github-button">Follow</a>
            <script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
       </div>

</div>

        </div>
        <footer>
            
            <h1></h1>
            <div class='col-md-5'> </div>
            <div class="col-md-3 container tagline">
                <a href="http://preaction.me/statocles">Made with Statocles</a><br/>
                <a href="http://www.perl.org">Powered by Perl</a>
            </div>
        </footer>
    </body>
</html>
