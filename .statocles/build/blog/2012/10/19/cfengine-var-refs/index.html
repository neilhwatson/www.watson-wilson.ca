<!DOCTYPE html>
<html>
    <head>
        <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
        <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
        <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
        <link href="/theme/css/readability-bootstrap.min.css" rel="stylesheet">
        <!--<link rel="stylesheet" href="/theme/css/statocles-bootstrap.css" />-->
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
        <title>Variable references with CFEngine - Neil H. Watson</title>
        <meta content="Statocles 0.065" name="generator">
        

        <!-- For source highlighting -->
        <link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/default.min.css" rel="stylesheet">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

    </head>
    <body>
        <header>
            <nav class="navbar navbar-default navbar-static-top" role="navigation">
                <div class="container">
                <!-- Brand and toggle get grouped for better mobile display -->
                    <div class="navbar-header">
                        <button class="navbar-toggle" data-target="#top-navbar-collapse-1" data-toggle="collapse" type="button">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="/">Neil H. Watson</a>
                    </div>
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse" id="top-navbar-collapse-1">
                        <ul class="nav navbar-nav">
                            <li><a href="/page/about">About me</a></li>
                            <li><a href="/static/resume_neil_h_watson.pdf">Resume</a></li>
                            <li><a href="/page/projects">Projects</a></li>
                        </ul>
                        
                    </div>
                </div>
            </nav>
            
        </header>
        <div class="main container">
            <div class="row">

    <div class="col-md-9">
        <main>
            <header>
                <h1>Variable references with CFEngine</h1>
                <p class="tags">Tags:
                    <a href="/blog/tag/cfengine/" rel="tag">cfengine</a>
                </p>

                <aside>
                    <p><time datetime="2012-10-19">
                        Posted on 2012-10-19
                    </time>
                    </p>
                </aside>


            </header>
            <section id="section-1">
                <p>Variables in CFEngine can be confusing at times. Here are some examples of
variable references. References are not strictly required, but they are good
practice like using the strict module in Perl.</p>

            </section>
            <section id="section-2">
                <p>bundle agent main {</p>

<pre><code>   vars:
      &quot;meta_purpose&quot; string =&gt; &quot;Demonstrate references&quot;;

      &quot;my_scalar&quot; string       =&gt; &quot;This is a scalar typed as astring&quot;;
      &quot;my_list&quot; slist          =&gt; { &quot;one&quot;, &quot;two&quot;, &quot;three&quot; };
      &quot;my_array[red]&quot; string   =&gt; &quot;Red element of associative array&quot;;
      &quot;my_array[blue]&quot; string  =&gt; &quot;Blue element of associative array&quot;;
      &quot;my_array[green]&quot; string =&gt; &quot;Green element of associative array&quot;;

   methods:
      &quot;any&quot; usebundle =&gt; test(
         &quot;main.my_scalar&quot;,
         &quot;main.my_list&quot;,
         &quot;main.my_array&quot;
         );
}

bundle agent test(scalarref, listref, arrayref) {

   vars:
      &quot;local_scalar&quot;
         string =&gt; &quot;${${scalarref}}&quot;;

      &quot;local_list&quot;
         slist =&gt; { &quot;@{${listref}}&quot; };

      &quot;arrayref_index&quot;
         slist =&gt; getindices(&quot;${arrayref}&quot;);

      &quot;local_array[${arrayref_index}]&quot;
         string =&gt; &quot;${${arrayref}[${arrayref_index}]}&quot;;

      &quot;local_array_index&quot;
         policy =&gt; &#39;free&#39;,
         slist =&gt; getindices(&quot;local_array&quot;);

   reports:
      cfengine::
         &quot;scalarref         =&gt; ${${scalarref}}&quot;;
         &quot;local_scalar      =&gt; ${local_scalar}&quot;;
         &quot;local_list        =&gt; ${local_list}&quot;;
         &quot;arrayref_index    =&gt; ${arrayref_index}&quot;;
         &quot;arrayref item     =&gt; ${${arrayref}[${arrayref_index}]}&quot;;
         &quot;local_array_index =&gt; ${local_array_index}&quot;;
         &quot;local_array item  =&gt; ${local_array[${local_array_index}]}&quot;;
}
</code></pre>

<p>Now let&#39;s run it:</p>

<pre><code>$ cf-agent -f ./references.cf 
R: scalarref         =&gt; This is a scalar typed as astring
R: local_scalar      =&gt; This is a scalar typed as astring
R: local_list        =&gt; one
R: local_list        =&gt; two
R: local_list        =&gt; three
R: arrayref_index    =&gt; red
R: arrayref_index    =&gt; blue
R: arrayref_index    =&gt; green
R: arrayref item     =&gt; Red element of associative array
R: arrayref item     =&gt; Blue element of associative array
R: arrayref item     =&gt; Green element of associative array
R: local_array_index =&gt; green
R: local_array_index =&gt; red
R: local_array_index =&gt; blue
R: local_array item  =&gt; Green element of associative array
R: local_array item  =&gt; Red element of associative array
R: local_array item  =&gt; Blue element of associative array
</code></pre>

            </section>
        </main>


    </div>

    <div class="col-md-3">
        <iframe frameborder="0" src="https://duckduckgo.com/search.html?site=watson-wilson.ca&amp;prefill=Search DuckDuckGo" style="overflow:hidden;margin:0;padding:0;width:350px;height:40px;"></iframe>

        <nav id="tags">
            <h1>Tags</h1>
            <ul class="list-inline">
                <li><a href="/blog/tag/apt/">apt</a></li>
                <li><a href="/blog/tag/backup/">backup</a></li>
                <li><a href="/blog/tag/cfengine/">cfengine</a></li>
                <li><a href="/blog/tag/cfengine-cookbook/">cfengine cookbook</a></li>
                <li><a href="/blog/tag/cheatsheet/">cheatsheet</a></li>
                <li><a href="/blog/tag/cli/">cli</a></li>
                <li><a href="/blog/tag/cloud/">cloud</a></li>
                <li><a href="/blog/tag/cluster/">cluster</a></li>
                <li><a href="/blog/tag/configuration-management/">configuration management</a></li>
                <li><a href="/blog/tag/cron/">cron</a></li>
                <li><a href="/blog/tag/debian/">debian</a></li>
                <li><a href="/blog/tag/dns/">dns</a></li>
                <li><a href="/blog/tag/dr/">dr</a></li>
                <li><a href="/blog/tag/heartbeat/">heartbeat</a></li>
                <li><a href="/blog/tag/high-availability/">high availability</a></li>
                <li><a href="/blog/tag/infosec/">infosec</a></li>
                <li><a href="/blog/tag/ipv6/">ipv6</a></li>
                <li><a href="/blog/tag/iscsi/">iscsi</a></li>
                <li><a href="/blog/tag/jekyll/">jekyll</a></li>
                <li><a href="/blog/tag/kvm/">kvm</a></li>
                <li><a href="/blog/tag/linux/">linux</a></li>
                <li><a href="/blog/tag/monitoring/">monitoring</a></li>
                <li><a href="/blog/tag/multipathd/">multipathd</a></li>
                <li><a href="/blog/tag/networking/">networking</a></li>
                <li><a href="/blog/tag/opensource/">opensource</a></li>
                <li><a href="/blog/tag/oracle/">oracle</a></li>
                <li><a href="/blog/tag/patching/">patching</a></li>
                <li><a href="/blog/tag/perl/">perl</a></li>
                <li><a href="/blog/tag/posix/">posix</a></li>
                <li><a href="/blog/tag/programming/">programming</a></li>
                <li><a href="/blog/tag/provisioning/">provisioning</a></li>
                <li><a href="/blog/tag/red-hat/">red hat</a></li>
                <li><a href="/blog/tag/regex/">regex</a></li>
                <li><a href="/blog/tag/rhev/">rhev</a></li>
                <li><a href="/blog/tag/san/">san</a></li>
                <li><a href="/blog/tag/satellite/">satellite</a></li>
                <li><a href="/blog/tag/scripting/">scripting</a></li>
                <li><a href="/blog/tag/shell/">shell</a></li>
                <li><a href="/blog/tag/solaris/">solaris</a></li>
                <li><a href="/blog/tag/spacewalk/">spacewalk</a></li>
                <li><a href="/blog/tag/ssh/">ssh</a></li>
                <li><a href="/blog/tag/statocles/">statocles</a></li>
                <li><a href="/blog/tag/subversion/">subversion</a></li>
                <li><a href="/blog/tag/sun/">sun</a></li>
                <li><a href="/blog/tag/support/">support</a></li>
                <li><a href="/blog/tag/svn/">svn</a></li>
                <li><a href="/blog/tag/sysadmin/">sysadmin</a></li>
                <li><a href="/blog/tag/terraform/">terraform</a></li>
                <li><a href="/blog/tag/vitualization/">vitualization</a></li>
                <li><a href="/blog/tag/website/">website</a></li>
            </ul>
        </nav>
    </div>

</div>

<div class="row">
   <div class="col-md-1">
       <img atl="Neil Watson" src="https://gravatar.com/avatar/1f0969599955a953e592034929ed7a23">
   </div>

       <div class="col-md-1">
            <!-- reddit this -->
            <a href="//www.reddit.com/submit" onclick="window.location = &#39;//www.reddit.com/submit?url=&#39; + encodeURIComponent(window.location); return false"><img alt="submit to reddit" border="0" src="//www.redditstatic.com/spreddit7.gif"></a>
       </div>

       <div class="col-md-1">
          <!-- Tweet this -->
          <a class="twitter-share-button" data-count="none" data-via="neil_h_watson" href="https://twitter.com/share">Tweet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
       </div>

       <div class="col-md-1">
          <!-- follow me on twitter -->
          <a class="twitter-follow-button" data-show-count="false" data-show-screen-name="false" href="https://twitter.com/neil_h_watson">Follow @neil_h_watson</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
        </div>

       <div class="col-md-1">
           <!-- follw me on github -->
            <a aria-label="Follow @neilhwatson on GitHub" class="github-button" data-style="mega" href="https://github.com/neilhwatson">Follow</a>
            <script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
       </div>

</div>

        </div>
        <footer>
            
            <h1></h1>
            <div class="col-md-5"> </div>
            <div class="col-md-3 container tagline">
                <a href="http://preaction.me/statocles">Made with Statocles</a><br>
                <a href="http://www.perl.org">Powered by Perl</a>
            </div>
        </footer>
    </body>
</html>
