<!DOCTYPE html>
<html>
    <head>
        <link href="/theme/css/normalize.css" rel="stylesheet">
        <link href="/theme/css/skeleton.css" rel="stylesheet">
        <link href="/theme/css/statocles-default.css" rel="stylesheet">
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
        <title>Variable references with Cfengine - Neil H. Watson</title>
        <meta content="Statocles 0.059" name="generator">
        
    </head>
    <body>
        <header>
            <nav class="navbar">
                <div class="container">
                    <a class="brand" href="/">Neil H. Watson</a>
                    <ul>
                        <li>
                            <a href="/">Blog</a>
                        </li>
                    </ul>
                    
                </div>
            </nav>
            
        </header>
        <div class="main container">
            <div class="row">

    <div class="nine columns">
        <main>
            <header>
                <h1>Variable references with Cfengine</h1>
                <p class="tags">Tags:
                    <a href="/blog/tag/cfengine/" rel="tag">cfengine</a>
                </p>

                <aside>
                    <p><time datetime="2012-10-19">
                        Posted on 2012-10-19
                    </time>
                    </p>
                </aside>


            </header>
            <section id="section-1">
                <p>Variables in Cfengine can be confusing at times. Here are some examples of variable references. References are not strictly required, but they are good practice like using the strict module in Perl.</p>

<p>bundle agent main {</p>

<p>vars:
      &quot;meta_purpose&quot; string =&gt; &quot;Demonstrate references&quot;;</p>

<pre><code>  &quot;my_scalar&quot; string       =&gt; &quot;This is a scalar typed as astring&quot;;
  &quot;my_list&quot; slist          =&gt; { &quot;one&quot;, &quot;two&quot;, &quot;three&quot; };
  &quot;my_array[red]&quot; string   =&gt; &quot;Red element of associative array&quot;;
  &quot;my_array[blue]&quot; string  =&gt; &quot;Blue element of associative array&quot;;
  &quot;my_array[green]&quot; string =&gt; &quot;Green element of associative array&quot;;
</code></pre>

<p>methods:
      &quot;any&quot; usebundle =&gt; test(
         &quot;main.my_scalar&quot;,
         &quot;main.my_list&quot;,
         &quot;main.my_array&quot;
         );
}</p>

<p>bundle agent test(scalarref, listref, arrayref) {</p>

<p>vars:
      &quot;local_scalar&quot;
         string =&gt; &quot;${${scalarref}}&quot;;</p>

<pre><code>  &quot;local_list&quot;
     slist =&gt; { &quot;@{${listref}}&quot; };

  &quot;arrayref_index&quot;
     slist =&gt; getindices(&quot;${arrayref}&quot;);

  &quot;local_array[${arrayref_index}]&quot;
     string =&gt; &quot;${${arrayref}[${arrayref_index}]}&quot;;

  &quot;local_array_index&quot;
     policy =&gt; &#39;free&#39;,
     slist =&gt; getindices(&quot;local_array&quot;);
</code></pre>

<p>reports:
      cfengine::
         &quot;scalarref         =&gt; ${${scalarref}}&quot;;
         &quot;local_scalar      =&gt; ${local_scalar}&quot;;
         &quot;local_list        =&gt; ${local_list}&quot;;
         &quot;arrayref_index    =&gt; ${arrayref_index}&quot;;
         &quot;arrayref item     =&gt; ${${arrayref}[${arrayref_index}]}&quot;;
         &quot;local_array_index =&gt; ${local_array_index}&quot;;
         &quot;local_array item  =&gt; ${local_array[${local_array_index}]}&quot;;
}</p>

<p>Now let&#39;s run it:</p>

<p>$ cf-agent -f ./references.cf 
R: scalarref         =&gt; This is a scalar typed as astring
R: local_scalar      =&gt; This is a scalar typed as astring
R: local_list        =&gt; one
R: local_list        =&gt; two
R: local_list        =&gt; three
R: arrayref_index    =&gt; red
R: arrayref_index    =&gt; blue
R: arrayref_index    =&gt; green
R: arrayref item     =&gt; Red element of associative array
R: arrayref item     =&gt; Blue element of associative array
R: arrayref item     =&gt; Green element of associative array
R: local_array_index =&gt; green
R: local_array_index =&gt; red
R: local_array_index =&gt; blue
R: local_array item  =&gt; Green element of associative array
R: local_array item  =&gt; Red element of associative array
R: local_array item  =&gt; Blue element of associative array</p>

            </section>
        </main>


    </div>

    <div class="three columns sidebar">
        
        <nav id="tags">
            <h1>Tags</h1>
            <ul class="list-inline">
                <li><a href="/blog/tag/apt/">apt</a></li>
                <li><a href="/blog/tag/backup/">backup</a></li>
                <li><a href="/blog/tag/cfengine/">cfengine</a></li>
                <li><a href="/blog/tag/cfengine-cookbook/">cfengine cookbook</a></li>
                <li><a href="/blog/tag/cheatsheet/">cheatsheet</a></li>
                <li><a href="/blog/tag/cli/">cli</a></li>
                <li><a href="/blog/tag/cluster/">cluster</a></li>
                <li><a href="/blog/tag/configuration-management/">configuration management</a></li>
                <li><a href="/blog/tag/cron/">cron</a></li>
                <li><a href="/blog/tag/debian/">debian</a></li>
                <li><a href="/blog/tag/dns/">dns</a></li>
                <li><a href="/blog/tag/dr/">dr</a></li>
                <li><a href="/blog/tag/heartbeat/">heartbeat</a></li>
                <li><a href="/blog/tag/high-availability/">high availability</a></li>
                <li><a href="/blog/tag/infosec/">infosec</a></li>
                <li><a href="/blog/tag/ipv6/">ipv6</a></li>
                <li><a href="/blog/tag/iscsi/">iscsi</a></li>
                <li><a href="/blog/tag/kvm/">kvm</a></li>
                <li><a href="/blog/tag/linux/">linux</a></li>
                <li><a href="/blog/tag/monitoring/">monitoring</a></li>
                <li><a href="/blog/tag/multipathd/">multipathd</a></li>
                <li><a href="/blog/tag/networking/">networking</a></li>
                <li><a href="/blog/tag/opensource/">opensource</a></li>
                <li><a href="/blog/tag/oracle/">oracle</a></li>
                <li><a href="/blog/tag/posix/">posix</a></li>
                <li><a href="/blog/tag/red-hat/">red hat</a></li>
                <li><a href="/blog/tag/regex/">regex</a></li>
                <li><a href="/blog/tag/rhev/">rhev</a></li>
                <li><a href="/blog/tag/san/">san</a></li>
                <li><a href="/blog/tag/shell/">shell</a></li>
                <li><a href="/blog/tag/solaris/">solaris</a></li>
                <li><a href="/blog/tag/ssh/">ssh</a></li>
                <li><a href="/blog/tag/subversion/">subversion</a></li>
                <li><a href="/blog/tag/sun/">sun</a></li>
                <li><a href="/blog/tag/support/">support</a></li>
                <li><a href="/blog/tag/svn/">svn</a></li>
                <li><a href="/blog/tag/sysadmin/">sysadmin</a></li>
                <li><a href="/blog/tag/vitualization/">vitualization</a></li>
            </ul>
        </nav>
    </div>

</div>

        </div>
        <footer>
            
            <div class="container tagline">
                <a href="http://preaction.github.io/Statocles">Made with Statocles</a><br>
                <a href="http://www.perl.org">Powered by Perl</a>
            </div>
        </footer>
    </body>
</html>
