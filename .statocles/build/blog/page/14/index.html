<!DOCTYPE html>
<html lang="en"> 
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" />
        <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
        <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
        <link rel="stylesheet" href="/theme/css/readability-bootstrap.min.css" />
        <!--<link rel="stylesheet" href="/theme/css/statocles-bootstrap.css" />-->
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
        <title>Neil H. Watson</title>
        <meta name="generator" content="Statocles 0.094" />
        <link rel="alternate" href="/blog/index.atom" type="application/atom+xml" />
        <link rel="alternate" href="/blog/index.rss" type="application/rss+xml" />
        

        <!-- Twitter for websites -->
         <script>window.twttr = (function(d, s, id) {
           var js, fjs = d.getElementsByTagName(s)[0],
             t = window.twttr || {};
           if (d.getElementById(id)) return t;
           js = d.createElement(s);
           js.id = id;
           js.src = "https://platform.twitter.com/widgets.js";
           fjs.parentNode.insertBefore(js, fjs);

           t._e = [];
           t.ready = function(f) {
             t._e.push(f);
           };

           return t;
         }(document, "script", "twitter-wjs"));</script>

        <!-- For source highlighting -->
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/default.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

    </head>
    <body>
        <header>
            <nav class="navbar navbar-default navbar-static-top" role="navigation">
                <div class="container">
                <!-- Brand and toggle get grouped for better mobile display -->
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#top-navbar-collapse-1">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="/">Neil H. Watson</a>
                    </div>
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse" id="top-navbar-collapse-1">
                        <ul class="nav navbar-nav">
                            <li><a href="/page/about">About me</a></li>
                            <li><a href="/static/resume_neil_h_watson.pdf">Resume</a></li>
                            <li><a href="/page/projects">Projects</a></li>
                            <li><a href="/page/evolvethinking">UPDATE: EvolveThinking</a></li>
                        </ul>
                        
                    </div>
                </div>
            </nav>
            
        </header>
        <div class="main container">
            
<div class="row">

    <div class="col-md-9">
        <main>


            <article>
                <header>
                    <h1><a href="/blog/2013/08/07/secure-sysctl-settings-with-cfengine/">Secure sysctl settings with CFEngine</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/cfengine/" rel="tag">cfengine</a>
                        <a href="/blog/tag/efl/" rel="tag">EFL</a>
                        <a href="/blog/tag/linux/" rel="tag">linux</a>
                        <a href="/blog/tag/security/" rel="tag">security</a>
                        <a href="/blog/tag/sysctl/" rel="tag">sysctl</a>
                    </p>

                    <aside>
                        <p><time datetime="2013-08-07">
                            Posted on 2013-08-07
                        </time>
                            by nwatson
                        </p>
                    </aside>

                </header>

                <p>Here&#39;s how to maintain Linux sysctl settings across all hosts in
an organization using the Evolve <a href="http://watson-wilson.ca/evolve-thinkings-free-cfengine-library/">free promise library</a>
and CFEngine. ---</p>

<p>Sysctl data is separated from CFEngine policy in its own data file.</p>

<pre><code># sysctl.txt
# Promise sysctl.conf and live kernel settings

# context(0) ;; sysctl variable name(1)         ;; value(2) ;; promisee(3)
any          ;; net.ipv6.conf.all.accept_ra     ;; 0        ;; ipv6 auto assign
any          ;; net.ipv6.conf.all.autoconf      ;; 0        ;; ipv6 auto assign
any          ;; net.ipv6.conf.default.autoconf  ;; 0        ;; ipv6 auto assign
any          ;; net.ipv6.conf.eth0.accept_ra    ;; 0        ;; ipv6 auto assign
sol          ;; net.ipv6.conf.bond0.accept_ra   ;; 0        ;; ipv6 auto assign

alix         ;; net.ipv6.conf.all.forwarding    ;; 1        ;; Routing
alix         ;; net.ipv4.ip_forward             ;; 1        ;; Routing
neptune      ;; proc.sys.kernel.sysrq           ;; 0        ;; Laptop security
</code></pre>

<p>Columns labeled 1 and 2 are the sysctl setting name and the value.
Column 3 is the promisee, used for documentation. Column 0 is the class
or context that must be true for the sysctl setting to be applied.</p>

<p>The Evolve free promise library has two sysctl bundles. One promises
live sysctl settings and the other promises the sysctl.conf file. Use
methods promises to call each bundle, passing the same parameter file.</p>

<pre><code>methods:

&quot;live sysctl settings&quot;
   usebundle =&gt; efl_sysctl_live( &quot;${sys.workdir}/inputs/bundle_params/sysctl.txt&quot; ),
   action    =&gt; if_elapsed( &quot;240&quot; );

&quot;sysctl conf settings&quot;
   usebundle =&gt; efl_sysctl_conf_file( &quot;${sys.workdir}/inputs/bundle_params/sysctl.txt&quot; ),
   action    =&gt; if_elapsed( &quot;240&quot; );
</code></pre>

<p>The live bundle calls the sysctl command often. If_elapsed is used to
reduce the load from excessive promise evaluation.</p>



            </article>
            <article>
                <header>
                    <h1><a href="/blog/2013/07/26/profiling-policy-performance-in-cfengine/">Profiling policy performance in CFEngine</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/cfengine/" rel="tag">cfengine</a>
                    </p>

                    <aside>
                        <p><time datetime="2013-07-26">
                            Posted on 2013-07-26
                        </time>
                            by nwatson
                        </p>
                    </aside>

                </header>

                <p><a href="http://www.loicp.eu/">Lo√Øc Pefferkorn</a> has created the <a href="https://github.com/lpefferkorn/cfe-profiler">cfe-profiler</a>.
It is a library that times the execution of CFEngine bundles in your
policy. Let&#39;s take a look.</p>


                    <p><a href="/blog/2013/07/26/profiling-policy-performance-in-cfengine/index.html#section-2">Continue reading Profiling policy performance in CFEngine...</a></p>

            </article>
            <article>
                <header>
                    <h1><a href="/blog/2013/07/19/polling-cfengine-with-opennms/">Polling CFEngine with Opennms</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/cfengine/" rel="tag">cfengine</a>
                        <a href="/blog/tag/monitoring/" rel="tag">monitoring</a>
                        <a href="/blog/tag/opennms/" rel="tag">opennms</a>
                    </p>

                    <aside>
                        <p><time datetime="2013-07-19">
                            Posted on 2013-07-19
                        </time>
                            by nwatson
                        </p>
                    </aside>

                </header>

                <p>In the coming months I&#39;m going to work with and write about <a href="http://www.opennms.org">Opennms</a>.
Started in 1999, Opennms is a mature, open source, enterprise scale
monitoring system.</p>


                    <p><a href="/blog/2013/07/19/polling-cfengine-with-opennms/index.html#section-2">Continue reading Polling CFEngine with Opennms...</a></p>

            </article>
            <article>
                <header>
                    <h1><a href="/blog/2013/05/09/evolve-thinkings-free-cfengine-library/">Evolve Thinking's free CFEngine library</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/cfengine/" rel="tag">cfengine</a>
                        <a href="/blog/tag/efl/" rel="tag">EFL</a>
                    </p>

                    <aside>
                        <p><time datetime="2013-05-09">
                            Posted on 2013-05-09
                        </time>
                            by nwatson
                        </p>
                    </aside>

                </header>

                <p>Our free CFEngine library empowers users to build and deploy new
policy faster, simplify existing policy, and reduce staff training. ---
We do this by offering simple reusable bundles and full data separation
using CSV parameter files.</p>

<p>Just as CFEngine uses a handful of promises to affect so much change on
a host, our small collection of bundles can accomplish most high level
tasks in CFEngine.</p>

<p>Typical CFEngine bundles in use today are too specialized. A bundle for
cron tables, a bundle for resolv.conf, and another for NTP. This is too
specialized and too costly. There is a better way. Simpler bundles can
offer greater flexibility and easier reuse at a lower cost. A single
service bundle can promise cron tables, NTP, and more. A single editing
template bundle can promise resolv.conf, the hosts file, shell
profiles, and more. Our library does this and more.</p>

<p>Consider this data file for the bundle <em>efl_chkconfig_enable_service</em>.
If the context class is true then the given service is enabled for boot
time start using the chkconfig command.</p>

<pre><code># context(0) ;; service name(1) ;; Promisee(3)

any          ;; cfengine3       ;; Sysadmin team
web_server   ;; apache2         ;; Web team
dev.dns      ;; bind            ;; Dev team
</code></pre>

<p>You can call the bundle like this:</p>

<pre><code>&quot;enable with chkconfig&quot;
usebundle =&gt; efl_chkconfig_enable_service(
   &quot;${sys.workdir}/inputs/user_data/bundle_params/efl_chkconfig_enable_service.txt&quot;
);
</code></pre>

<p>To enable a new service, change only the data file. The promisee is
very important. It will help you to find all related data. Labelling a
promisee &quot;SSH services for DMZ&quot; will help find all SSH entries, in all
data files using a single search.</p>

<p>Our library offers a further step in data separation. The method above
can be placed in a data file. The bundle efl_main takes a data file
that describes method calls and parameters. For example:</p>

<pre><code># context(0) ;; promiser(1) ;; bundle(2) ;; ifelapsed(3) ;; parameter(4) ;; promisee(5)

any ;; host classes ;; efl_class_hostname ;; 1 ;; /var/cfengine/inputs/user_data/classes/efl_class_hostname-ipv6_only.txt ;; Neil Watson
any ;; chkconfig enable ;; efl_chkconfig_enable_service ;; 1 ;; /var/cfengine/inputs/user_data/bundle_params/efl_chkconfig_enable_service.txt ;; Neil Watson
</code></pre>

<p>When the given context is true a bundle is invoked with the given
parameter and using <em>ifelapsed</em>.</p>

<p>At this release the free library offer these bundles and more:</p>

<ul>
<li><p>Enable and disable services using chkconfig.</p></li>
<li><p>Install and remove packages.</p></li>
<li><p>Promise sysctl.conf.</p></li>
<li><p>Promise live sysctl kernel settings.</p></li>
<li><p>Delete files.</p></li>
<li><p>Copy files.</p></li>
<li><p>Edit templates.</p></li>
<li><p>Promise commands.</p></li>
<li><p>Define classes</p></li>
<li><p>Promise links.</p></li>
<li><p>Define global variables.</p></li>
<li><p>Promise that services are configured and running.</p></li>
<li><p>Promise file permissions.</p></li>
</ul>

<p>In the future we&#39;ll be offering special purpose bundles that use these
simple bundles, ready to use parameter files, and more.</p>

<p>The Evolve free library is open source and available at my <a href="https://github.com/neilhwatson/">Git Hub
site.</a></p>



            </article>
            <article>
                <header>
                    <h1><a href="/blog/2013/05/09/pcre-cheatsheet/">PCRE cheatsheet</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/cfengine/" rel="tag">cfengine</a>
                        <a href="/blog/tag/cheatsheet/" rel="tag">cheatsheet</a>
                        <a href="/blog/tag/pcre/" rel="tag">pcre</a>
                        <a href="/blog/tag/regex/" rel="tag">regex</a>
                    </p>

                    <aside>
                        <p><time datetime="2013-05-09">
                            Posted on 2013-05-09
                        </time>
                            by nwatson
                        </p>
                    </aside>

                </header>

                <p>Although similar to Perl, PCRE has some syntax that can be
difficult to remember. When I&#39;m working with CFEngine I often have to
look it up. Here is a cheat-sheet to save time.</p>


                    <p><a href="/blog/2013/05/09/pcre-cheatsheet/index.html#section-2">Continue reading PCRE cheatsheet...</a></p>

            </article>
        </main>

        <ul class="pager">
            <li class="previous ">
                <a rel="next" href="/blog/page/15/"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Older</a>
            </li>
            <li class="next ">
                <a rel="prev" href="/blog/page/13/">Newer<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
            </li>
        </ul>

    </div>

    <div class="sidebar col-md-3">
        <iframe src="https://duckduckgo.com/search.html?site=watson-wilson.ca&prefill=Search DuckDuckGo" style="overflow:hidden;margin:0;padding:0;width:350px;height:40px;" frameborder="0"></iframe>

        <h1>Tags</h1>
        <ul class="list-inline">
            <li><a href="/blog/tag/ansible/">ansible</a></li>
            <li><a href="/blog/tag/anti-virus/">anti-virus</a></li>
            <li><a href="/blog/tag/apt/">apt</a></li>
            <li><a href="/blog/tag/asg/">asg</a></li>
            <li><a href="/blog/tag/autoscaling/">autoscaling</a></li>
            <li><a href="/blog/tag/aws/">AWS</a></li>
            <li><a href="/blog/tag/azure/">azure</a></li>
            <li><a href="/blog/tag/backup/">backup</a></li>
            <li><a href="/blog/tag/best-practices/">best practices</a></li>
            <li><a href="/blog/tag/bitbucket/">bitbucket</a></li>
            <li><a href="/blog/tag/bosh/">bosh</a></li>
            <li><a href="/blog/tag/cfengine/">cfengine</a></li>
            <li><a href="/blog/tag/cfengine-cookbook/">cfengine cookbook</a></li>
            <li><a href="/blog/tag/cheatsheet/">cheatsheet</a></li>
            <li><a href="/blog/tag/cli/">cli</a></li>
            <li><a href="/blog/tag/cloud/">cloud</a></li>
            <li><a href="/blog/tag/cloud-foundry/">cloud foundry</a></li>
            <li><a href="/blog/tag/cluster/">cluster</a></li>
            <li><a href="/blog/tag/conferences/">conferences</a></li>
            <li><a href="/blog/tag/configuration-management/">configuration management</a></li>
            <li><a href="/blog/tag/containers/">containers</a></li>
            <li><a href="/blog/tag/continuous-integration/">continuous integration</a></li>
            <li><a href="/blog/tag/cron/">cron</a></li>
            <li><a href="/blog/tag/debian/">debian</a></li>
            <li><a href="/blog/tag/delta-reporting/">delta reporting</a></li>
            <li><a href="/blog/tag/devops/">devops</a></li>
            <li><a href="/blog/tag/dns/">dns</a></li>
            <li><a href="/blog/tag/docker/">docker</a></li>
            <li><a href="/blog/tag/dr/">dr</a></li>
            <li><a href="/blog/tag/efl/">EFL</a></li>
            <li><a href="/blog/tag/ergonomics/">ergonomics</a></li>
            <li><a href="/blog/tag/github/">github</a></li>
            <li><a href="/blog/tag/heartbeat/">heartbeat</a></li>
            <li><a href="/blog/tag/high-availability/">high availability</a></li>
            <li><a href="/blog/tag/infosec/">infosec</a></li>
            <li><a href="/blog/tag/ipv6/">ipv6</a></li>
            <li><a href="/blog/tag/irc/">irc</a></li>
            <li><a href="/blog/tag/iscsi/">iscsi</a></li>
            <li><a href="/blog/tag/jekyll/">jekyll</a></li>
            <li><a href="/blog/tag/jq/">jq</a></li>
            <li><a href="/blog/tag/json/">json</a></li>
            <li><a href="/blog/tag/keyboard/">keyboard</a></li>
            <li><a href="/blog/tag/kickstart/">kickstart</a></li>
            <li><a href="/blog/tag/kvm/">kvm</a></li>
            <li><a href="/blog/tag/lambda/">lambda</a></li>
            <li><a href="/blog/tag/linux/">linux</a></li>
            <li><a href="/blog/tag/markdown/">markdown</a></li>
            <li><a href="/blog/tag/monitoring/">monitoring</a></li>
            <li><a href="/blog/tag/multipathd/">multipathd</a></li>
            <li><a href="/blog/tag/mustache/">mustache</a></li>
            <li><a href="/blog/tag/networking/">networking</a></li>
            <li><a href="/blog/tag/opennms/">opennms</a></li>
            <li><a href="/blog/tag/opensource/">opensource</a></li>
            <li><a href="/blog/tag/oracle/">oracle</a></li>
            <li><a href="/blog/tag/orchestration/">orchestration</a></li>
            <li><a href="/blog/tag/patching/">patching</a></li>
            <li><a href="/blog/tag/pcre/">pcre</a></li>
            <li><a href="/blog/tag/perl/">perl</a></li>
            <li><a href="/blog/tag/posix/">posix</a></li>
            <li><a href="/blog/tag/programming/">programming</a></li>
            <li><a href="/blog/tag/provisioning/">provisioning</a></li>
            <li><a href="/blog/tag/python/">python</a></li>
            <li><a href="/blog/tag/red-hat/">red hat</a></li>
            <li><a href="/blog/tag/redhat/">redhat</a></li>
            <li><a href="/blog/tag/regex/">regex</a></li>
            <li><a href="/blog/tag/rhev/">rhev</a></li>
            <li><a href="/blog/tag/ruby/">ruby</a></li>
            <li><a href="/blog/tag/san/">san</a></li>
            <li><a href="/blog/tag/satellite/">satellite</a></li>
            <li><a href="/blog/tag/scripting/">scripting</a></li>
            <li><a href="/blog/tag/security/">security</a></li>
            <li><a href="/blog/tag/serverless/">serverless</a></li>
            <li><a href="/blog/tag/serverspec/">serverspec</a></li>
            <li><a href="/blog/tag/shell/">shell</a></li>
            <li><a href="/blog/tag/slaac/">slaac</a></li>
            <li><a href="/blog/tag/software-testing/">software testing</a></li>
            <li><a href="/blog/tag/solaris/">solaris</a></li>
            <li><a href="/blog/tag/spacewalk/">spacewalk</a></li>
            <li><a href="/blog/tag/ssh/">ssh</a></li>
            <li><a href="/blog/tag/statocles/">statocles</a></li>
            <li><a href="/blog/tag/subnet/">subnet</a></li>
            <li><a href="/blog/tag/subversion/">subversion</a></li>
            <li><a href="/blog/tag/sun/">sun</a></li>
            <li><a href="/blog/tag/support/">support</a></li>
            <li><a href="/blog/tag/svn/">svn</a></li>
            <li><a href="/blog/tag/sysadmin/">sysadmin</a></li>
            <li><a href="/blog/tag/sysctl/">sysctl</a></li>
            <li><a href="/blog/tag/terraform/">terraform</a></li>
            <li><a href="/blog/tag/virus/">virus</a></li>
            <li><a href="/blog/tag/vitualization/">vitualization</a></li>
            <li><a href="/blog/tag/website/">website</a></li>
            <li><a href="/blog/tag/yaml/">yaml</a></li>
            <li><a href="/blog/tag/yamllint/">yamllint</a></li>
        </ul>
        <h1>Feeds</h1>
        <ul class="list-inline">
            <li>
                <a href="/blog/index.atom" rel="alternate" type="application/atom+xml">
                    Atom
                </a>
            </li>
            <li>
                <a href="/blog/index.rss" rel="alternate" type="application/rss+xml">
                    RSS
                </a>
            </li>
        </ul>
    </div>

</div>


        </div>
        <footer>
            
            <h1></h1>
            <div class='col-md-5'> </div>
            <div class="col-md-3 container tagline">
                <a href="http://preaction.me/statocles">Made with Statocles</a><br/>
                <a href="http://www.perl.org">Powered by Perl</a>
            </div>
        </footer>
    </body>
</html>
