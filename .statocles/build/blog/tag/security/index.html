<!DOCTYPE html>
<html>
    <head>
        <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
        <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
        <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
        <link href="/theme/css/readability-bootstrap.min.css" rel="stylesheet">
        <!--<link rel="stylesheet" href="/theme/css/statocles-bootstrap.css" />-->
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
        <title>Neil H. Watson</title>
        <meta content="Statocles 0.073" name="generator">
        <link href="/blog/tag/security.atom" rel="alternate" type="application/atom+xml">
        <link href="/blog/tag/security.rss" rel="alternate" type="application/rss+xml">
        

        <!-- For source highlighting -->
        <link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/default.min.css" rel="stylesheet">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

    </head>
    <body>
        <header>
            <nav class="navbar navbar-default navbar-static-top" role="navigation">
                <div class="container">
                <!-- Brand and toggle get grouped for better mobile display -->
                    <div class="navbar-header">
                        <button class="navbar-toggle" data-target="#top-navbar-collapse-1" data-toggle="collapse" type="button">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="/">Neil H. Watson</a>
                    </div>
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse" id="top-navbar-collapse-1">
                        <ul class="nav navbar-nav">
                            <li><a href="/page/about">About me</a></li>
                            <li><a href="/static/resume_neil_h_watson.pdf">Resume</a></li>
                            <li><a href="/page/projects">Projects</a></li>
                            <li><a href="/page/evolvethinking">UPDATE: EvolveThinking</a></li>
                        </ul>
                        
                    </div>
                </div>
            </nav>
            
        </header>
        <div class="main container">
            
<div class="row">

    <div class="col-md-9">
        <main>


            <article>
                <header>
                    <h1><a href="/blog/2015/09/30/essential-audit-reports-with-delta-reporting/">Essential audit reports with Delta Reporting</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/cfengine/" rel="tag">cfengine</a>
                        <a href="/blog/tag/delta-reporting/" rel="tag">delta reporting</a>
                        <a href="/blog/tag/security/" rel="tag">security</a>
                    </p>

                    <aside>
                        <p><time datetime="2015-09-30">
                            Posted on 2015-09-30
                        </time>
                            by nwatson
                        </p>
                    </aside>

                </header>

                <p>[caption id=&quot;attachment_960&quot; align=&quot;alignright&quot; width=&quot;620&quot;]<a href="/static/images/dr-dashboard.png"><img alt="Delta Reporting dashboard" src="/static/images/dr-dashboard.png"></a>
Delta Reporting dashboard[/caption] Delta Reporting has simple yet
powerful reports. See a gallery of essential ones <a href="http://watson-wilson.ca/products/delta-reporting/essential-audit-reports-with-delta-reporting/">here</a>.</p>



            </article>
            <article>
                <header>
                    <h1><a href="/blog/2015/09/18/auditing-hosts-using-cfengine-efl-and-delta-reporting/">Auditing hosts using CFEngine, EFL, and Delta Reporting</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/cfengine/" rel="tag">cfengine</a>
                        <a href="/blog/tag/delta-reporting/" rel="tag">delta reporting</a>
                        <a href="/blog/tag/EFL/" rel="tag">EFL</a>
                        <a href="/blog/tag/security/" rel="tag">security</a>
                        <a href="/blog/tag/software-testing/" rel="tag">software testing</a>
                    </p>

                    <aside>
                        <p><time datetime="2015-09-18">
                            Posted on 2015-09-18
                        </time>
                            by nwatson
                        </p>
                    </aside>

                </header>

                <p><img alt="" src="/static/images/Liste-300px.png"></p>

<p>Sometimes you want to audit a host without changing it. This can be
hard with CFEngine, but with <a href="https://github.com/neilhwatson/evolve_cfengine_freelib">EFL</a>
and <a href="https://github.com/neilhwatson/delta_reporting">Delta Reporting</a>
it&#39;s possible.</p>


                    <p><a href="/blog/2015/09/18/auditing-hosts-using-cfengine-efl-and-delta-reporting/index.html#section-2">Continue reading Auditing hosts using CFEngine, EFL, and Delta Reporting...</a></p>

            </article>
            <article>
                <header>
                    <h1><a href="/blog/2014/09/26/shellshock-free-with-cfengine-and-delta-reporting/">Shellshock free with CFEngine and Delta Reporting</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/cfengine/" rel="tag">cfengine</a>
                        <a href="/blog/tag/delta-reporting/" rel="tag">delta reporting</a>
                        <a href="/blog/tag/EFL/" rel="tag">EFL</a>
                        <a href="/blog/tag/security/" rel="tag">security</a>
                    </p>

                    <aside>
                        <p><time datetime="2014-09-26">
                            Posted on 2014-09-26
                        </time>
                            by nwatson
                        </p>
                    </aside>

                </header>

                <p>[caption id=&quot;attachment_1052&quot; align=&quot;alignnone&quot; width=&quot;716&quot;]<a href="/static/images/shell_shock.png"><img alt="Hosts reported free of shell shock" src="/static/images/shell_shock.png"></a>
Hosts reported free of shell shock[/caption]</p>

<p>Above is a screenshot from Evolve&#39;s production <a href="https://github.com/neilhwatson/delta_reporting">Delta Reporting</a>
service. These hosts are safe from Shell shock. Thanks to Delta
Reporting, <a href="https://github.com/neilhwatson/evolve_cfengine_freelib">EFL</a>,
and <a href="http://cfengine.com">CFEngine</a> our journey to a safe harbour was
not long. First we had to design a test for the vulnerability.</p>


                    <p><a href="/blog/2014/09/26/shellshock-free-with-cfengine-and-delta-reporting/index.html#section-2">Continue reading Shellshock free with CFEngine and Delta Reporting...</a></p>

            </article>
            <article>
                <header>
                    <h1><a href="/blog/2013/08/07/secure-sysctl-settings-with-cfengine/">Secure sysctl settings with CFEngine</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/cfengine/" rel="tag">cfengine</a>
                        <a href="/blog/tag/EFL/" rel="tag">EFL</a>
                        <a href="/blog/tag/linux/" rel="tag">linux</a>
                        <a href="/blog/tag/security/" rel="tag">security</a>
                        <a href="/blog/tag/sysctl/" rel="tag">sysctl</a>
                    </p>

                    <aside>
                        <p><time datetime="2013-08-07">
                            Posted on 2013-08-07
                        </time>
                            by nwatson
                        </p>
                    </aside>

                </header>

                <p>Here&#39;s how to maintain Linux sysctl settings across all hosts in
an organization using the Evolve <a href="http://watson-wilson.ca/evolve-thinkings-free-cfengine-library/">free promise library</a>
and CFEngine. ---</p>

<p>Sysctl data is separated from CFEngine policy in its own data file.</p>

<p>``</p>

<pre><code># sysctl.txt
# Promise sysctl.conf and live kernel settings

# context(0) ;; sysctl variable name(1)         ;; value(2) ;; promisee(3)
any          ;; net.ipv6.conf.all.accept_ra     ;; 0        ;; ipv6 auto assign
any          ;; net.ipv6.conf.all.autoconf      ;; 0        ;; ipv6 auto assign
any          ;; net.ipv6.conf.default.autoconf  ;; 0        ;; ipv6 auto assign
any          ;; net.ipv6.conf.eth0.accept_ra    ;; 0        ;; ipv6 auto assign
sol          ;; net.ipv6.conf.bond0.accept_ra   ;; 0        ;; ipv6 auto assign

alix         ;; net.ipv6.conf.all.forwarding    ;; 1        ;; Routing
alix         ;; net.ipv4.ip_forward             ;; 1        ;; Routing
neptune      ;; proc.sys.kernel.sysrq           ;; 0        ;; Laptop security
</code></pre>

<p>Columns labeled 1 and 2 are the sysctl setting name and the value.
Column 3 is the promisee, used for documentation. Column 0 is the class
or context that must be true for the sysctl setting to be applied.</p>

<p>The Evolve free promise library has two sysctl bundles. One promises
live sysctl settings and the other promises the sysctl.conf file. Use
methods promises to call each bundle, passing the same parameter file.</p>

<p>``</p>

<pre><code>methods:

&quot;live sysctl settings&quot;
   usebundle =&gt; efl_sysctl_live( &quot;${sys.workdir}/inputs/bundle_params/sysctl.txt&quot; ),
   action    =&gt; if_elapsed( &quot;240&quot; );

&quot;sysctl conf settings&quot;
   usebundle =&gt; efl_sysctl_conf_file( &quot;${sys.workdir}/inputs/bundle_params/sysctl.txt&quot; ),
   action    =&gt; if_elapsed( &quot;240&quot; );
</code></pre>

<p>The live bundle calls the sysctl command often. If_elapsed is used to
reduce the load from excessive promise evaluation.</p>



            </article>
            <article>
                <header>
                    <h1><a href="/blog/2013/05/09/its-time-to-rethink-anti-virus/">It&#39;s time to rethink Anti-virus</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/anti-virus/" rel="tag">anti-virus</a>
                        <a href="/blog/tag/security/" rel="tag">security</a>
                        <a href="/blog/tag/virus/" rel="tag">virus</a>
                    </p>

                    <aside>
                        <p><time datetime="2013-05-09">
                            Posted on 2013-05-09
                        </time>
                            by nwatson
                        </p>
                    </aside>

                </header>

                <p>Anti-virus is always a step behind. It&#39;s a good revenue stream for
anti-virus software makers. For end users it&#39;s a race to the horizon.
--- Virus pattern recognition only works on patterns that have been
discovered, researched, and added to the pattern database. Recent
anti-virus pattern databases now detect more than 22 million patterns.
Is it a wonder that anti-virus software kills computer performance? <a href="http://www.symantec.com/security_response/definitions/certified/">1</a></p>

<p>The impossible pattern race is bad. The system crippling false alarms
are worse. In the recent past most major anti-virus tools have crippled
corporate and person computers by mistakenly quarantining a Windows
system or application file.<a href="http://www.theregister.co.uk/2013/02/06/kaspersky_win_xp_update_snafu/">1</a>,
<a href="http://www.theregister.co.uk/2012/09/20/sophos_auto_immune_update_chaos/">2</a>,
<a href="http://www.pcmag.com/article2/0,2817,2362926,00.asp">3</a></p>

<p>I&#39;m not a computer virus expert. But there has to be a better way to
protect us. I can think of some.</p>

<p>White listing defines what files are allowed to execute on a system.
Any file not on the white list is denied execution. For most corporate
workstations this is ideal. A few hundred executable files are white
listed and the workstation becomes secure. More generic workstations,
like home computers, require longer lists. This is not insurmountable.
I&#39;d rather subscribe to a ten thousand item white list than a 22
million item black list. The look ups will be shorter and new threats
do not get an automatic free pass.</p>

<p>Mandatory access control. SELinux is the well known form of MAC. MAC is
similar to white listing but goes further. Programs are not just denied
execution rights. Their rights to access the rest of the system are
explicitly defined. For example, a web browser may be allowed to touch
printing, browser cache, and other relevant files. Anything else is
denied, by default. Viruses cannot run wild on the system because
they&#39;ve not been defined to be allowed to do so. Set up and maintenance
of such a systems is no small task. Neither is maintaining a growing
list of 22 million virus definitions.</p>

<p>I&#39;m not a computer virus expert. But the arms race between new viruses
and new definitions can never be won. It&#39;s time for a new approach.
Consider that the next time your computer is churning another
anti-virus disk scan.</p>



            </article>
        </main>

        <ul class="pager">
            <li class="previous disabled">
                <span><span aria-hidden="true" class="glyphicon glyphicon-chevron-left"></span>Older</span>
            </li>
            <li class="next disabled">
                <span>Newer<span aria-hidden="true" class="glyphicon glyphicon-chevron-right"></span></span>
            </li>
        </ul>

    </div>

    <div class="sidebar col-md-3">
        <iframe frameborder="0" src="https://duckduckgo.com/search.html?site=watson-wilson.ca&amp;prefill=Search DuckDuckGo" style="overflow:hidden;margin:0;padding:0;width:350px;height:40px;"></iframe>

        <h1>Tags</h1>
        <ul class="list-inline">
            <li><a href="/blog/tag/EFL/">EFL</a></li>
            <li><a href="/blog/tag/anti-virus/">anti-virus</a></li>
            <li><a href="/blog/tag/apt/">apt</a></li>
            <li><a href="/blog/tag/backup/">backup</a></li>
            <li><a href="/blog/tag/best-practices/">best practices</a></li>
            <li><a href="/blog/tag/cfengine/">cfengine</a></li>
            <li><a href="/blog/tag/cfengine-cookbook/">cfengine cookbook</a></li>
            <li><a href="/blog/tag/cheatsheet/">cheatsheet</a></li>
            <li><a href="/blog/tag/cli/">cli</a></li>
            <li><a href="/blog/tag/cloud/">cloud</a></li>
            <li><a href="/blog/tag/cluster/">cluster</a></li>
            <li><a href="/blog/tag/conferences/">conferences</a></li>
            <li><a href="/blog/tag/configuration-management/">configuration management</a></li>
            <li><a href="/blog/tag/cron/">cron</a></li>
            <li><a href="/blog/tag/debian/">debian</a></li>
            <li><a href="/blog/tag/delta-reporting/">delta reporting</a></li>
            <li><a href="/blog/tag/devops/">devops</a></li>
            <li><a href="/blog/tag/dns/">dns</a></li>
            <li><a href="/blog/tag/dr/">dr</a></li>
            <li><a href="/blog/tag/heartbeat/">heartbeat</a></li>
            <li><a href="/blog/tag/high-availability/">high availability</a></li>
            <li><a href="/blog/tag/infosec/">infosec</a></li>
            <li><a href="/blog/tag/ipv6/">ipv6</a></li>
            <li><a href="/blog/tag/irc/">irc</a></li>
            <li><a href="/blog/tag/iscsi/">iscsi</a></li>
            <li><a href="/blog/tag/jekyll/">jekyll</a></li>
            <li><a href="/blog/tag/kickstart/">kickstart</a></li>
            <li><a href="/blog/tag/kvm/">kvm</a></li>
            <li><a href="/blog/tag/linux/">linux</a></li>
            <li><a href="/blog/tag/monitoring/">monitoring</a></li>
            <li><a href="/blog/tag/multipathd/">multipathd</a></li>
            <li><a href="/blog/tag/mustache/">mustache</a></li>
            <li><a href="/blog/tag/networking/">networking</a></li>
            <li><a href="/blog/tag/opennms/">opennms</a></li>
            <li><a href="/blog/tag/opensource/">opensource</a></li>
            <li><a href="/blog/tag/oracle/">oracle</a></li>
            <li><a href="/blog/tag/patching/">patching</a></li>
            <li><a href="/blog/tag/pcre/">pcre</a></li>
            <li><a href="/blog/tag/perl/">perl</a></li>
            <li><a href="/blog/tag/posix/">posix</a></li>
            <li><a href="/blog/tag/programming/">programming</a></li>
            <li><a href="/blog/tag/provisioning/">provisioning</a></li>
            <li><a href="/blog/tag/red-hat/">red hat</a></li>
            <li><a href="/blog/tag/redhat/">redhat</a></li>
            <li><a href="/blog/tag/regex/">regex</a></li>
            <li><a href="/blog/tag/rhev/">rhev</a></li>
            <li><a href="/blog/tag/san/">san</a></li>
            <li><a href="/blog/tag/satellite/">satellite</a></li>
            <li><a href="/blog/tag/scripting/">scripting</a></li>
            <li><a href="/blog/tag/security/">security</a></li>
            <li><a href="/blog/tag/serverspec/">serverspec</a></li>
            <li><a href="/blog/tag/shell/">shell</a></li>
            <li><a href="/blog/tag/software-testing/">software testing</a></li>
            <li><a href="/blog/tag/solaris/">solaris</a></li>
            <li><a href="/blog/tag/spacewalk/">spacewalk</a></li>
            <li><a href="/blog/tag/ssh/">ssh</a></li>
            <li><a href="/blog/tag/statocles/">statocles</a></li>
            <li><a href="/blog/tag/subversion/">subversion</a></li>
            <li><a href="/blog/tag/sun/">sun</a></li>
            <li><a href="/blog/tag/support/">support</a></li>
            <li><a href="/blog/tag/svn/">svn</a></li>
            <li><a href="/blog/tag/sysadmin/">sysadmin</a></li>
            <li><a href="/blog/tag/sysctl/">sysctl</a></li>
            <li><a href="/blog/tag/terraform/">terraform</a></li>
            <li><a href="/blog/tag/virus/">virus</a></li>
            <li><a href="/blog/tag/vitualization/">vitualization</a></li>
            <li><a href="/blog/tag/website/">website</a></li>
        </ul>
        <h1>Feeds</h1>
        <ul class="list-inline">
            <li>
                <a href="/blog/tag/security.atom" rel="alternate" type="application/atom+xml">
                    Atom
                </a>
            </li>
            <li>
                <a href="/blog/tag/security.rss" rel="alternate" type="application/rss+xml">
                    RSS
                </a>
            </li>
        </ul>
    </div>

</div>


        </div>
        <footer>
            
            <h1></h1>
            <div class="col-md-5"> </div>
            <div class="col-md-3 container tagline">
                <a href="http://preaction.me/statocles">Made with Statocles</a><br>
                <a href="http://www.perl.org">Powered by Perl</a>
            </div>
        </footer>
    </body>
</html>
