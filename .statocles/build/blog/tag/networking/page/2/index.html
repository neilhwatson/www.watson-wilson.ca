<!DOCTYPE html>
<html>
    <head>
        <link href="/theme/css/normalize.css" rel="stylesheet">
        <link href="/theme/css/skeleton.css" rel="stylesheet">
        <link href="/theme/css/statocles-default.css" rel="stylesheet">
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
        <title>Neil H. Watson</title>
        <meta content="Statocles 0.059" name="generator">
        <link href="/blog/tag/networking.atom" rel="alternate" type="application/atom+xml">
        <link href="/blog/tag/networking.rss" rel="alternate" type="application/rss+xml">
        
    </head>
    <body>
        <header>
            <nav class="navbar">
                <div class="container">
                    <a class="brand" href="/">Neil H. Watson</a>
                    <ul>
                        <li>
                            <a href="/">Blog</a>
                        </li>
                    </ul>
                    
                </div>
            </nav>
            
        </header>
        <div class="main container">
            
<div class="row">

    <div class="nine columns">
        <main>


            <article>
                <header>
                    <h1><a href="/blog/2011/12/23/ipv6-migration-part3/">IPv6 Migration part 3</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/ipv6/" rel="tag">ipv6</a>
                        <a href="/blog/tag/networking/" rel="tag">networking</a>
                    </p>

                    <aside>
                        <p><time datetime="2011-12-23">
                            Posted on 2011-12-23
                        </time>
                        </p>
                    </aside>

                </header>

                <p>We continue in this series by having a quick look at a dual stack VPS host.</p>

<p>Alas many providers, including my ISP, do not yet offer IPV6 addresses. Fortunately my hosting provider does. I have a multipurpose VPS with them. Before this article the VPS had one IPV4 address. Using my provider&#39;s website I requested an IPV6 address. It’s worth noting that an IPV4 address costs me €2.00 per month. An IPV6 address cost only €0.10 per month.</p>

<p>After I made the request, I returned a day later expecting to have to set things up. I was surprised to see everything just worked. IPV6 address can be assigned by stateless configuration. This is built in to IPV6 beyond regular use of DHCPv6. I&#39;m not sure how my provided assigned the IP but it must have been easy and automatic.</p>

<p>venet0    Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 <br>
          inet addr:127.0.0.1  P-t-P:127.0.0.1  Bcast:0.0.0.0  Mask:255.255.255.255
          inet6 addr: ::1/128 Scope:Host
          inet6 addr: 2a02:750:5::464/128 Scope:Global
          UP BROADCAST POINTOPOINT RUNNING NOARP  MTU:1500  Metric:1
          RX packets:13899581 errors:0 dropped:0 overruns:0 frame:0
          TX packets:11227895 errors:0 dropped:6422 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:13392292622 (12.4 GiB)  TX bytes:1196669117 (1.1 GiB)</p>

<p>venet0:0  Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 <br>
          inet addr:46.21.104.226  P-t-P:46.21.104.226  Bcast:0.0.0.0  Mask:255.255.255.255
          UP BROADCAST POINTOPOINT RUNNING NOARP  MTU:1500  Metric:1</p>

<p>This host has one IPV4 address and one IPV6 address. I can access the host through IPV4 and my IPV6 tunnel.</p>

<p>PING 46.21.104.226 (46.21.104.226) 56(84) bytes of data.
64 bytes from 46.21.104.226: icmp_req=1 ttl=50 time=145 ms
64 bytes from 46.21.104.226: icmp_req=2 ttl=50 time=145 ms
64 bytes from 46.21.104.226: icmp_req=3 ttl=50 time=145 ms</p>

<p>--- 46.21.104.226 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2001ms
rtt min/avg/max/mdev = 145.177/145.509/145.784/0.251 ms</p>

<p>PING 2a02:750:5::464(2a02:750:5::464) 56 data bytes
64 bytes from 2a02:750:5::464: icmp_seq=1 ttl=53 time=160 ms
64 bytes from 2a02:750:5::464: icmp_seq=2 ttl=53 time=159 ms
64 bytes from 2a02:750:5::464: icmp_seq=3 ttl=53 time=158 ms</p>

<p>--- 2a02:750:5::464 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2002ms
rtt min/avg/max/mdev = 158.861/159.709/160.406/0.718 ms</p>

<p>Assigning both IPV4 and IPV6 addresses is a good way to transition to IPV6. It allows the host to access both worlds. Most reputable network services will happily work on both types of addresses. Just be aware that services like DHCP and packet filtering are entirely separate.</p>



            </article>
            <article>
                <header>
                    <h1><a href="/blog/2011/12/06/ipv6-migration-part2/">IPv6 Migration part 2</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/ipv6/" rel="tag">ipv6</a>
                        <a href="/blog/tag/networking/" rel="tag">networking</a>
                    </p>

                    <aside>
                        <p><time datetime="2011-12-06">
                            Posted on 2011-12-06
                        </time>
                        </p>
                    </aside>

                </header>

                <p>In this part of the series we will learn how to make a service run on an IPV6 address.</p>

<p>In part one of this IPV6 series we discussed the setup of an IPV6 tunnel. In part two we’ll look at setting up an IPV6 available website.</p>

<p>My first task was to configure a DNS record. IPV6 has its own DNS record types. In this simple test I only need the A record equivalent, the AAAA or quad-a record. These look like this.</p>

<p>ipv6.watson-wilson.ca.      IN AAAA 2604:8800:100:111::2</p>

<p>Lookups are done like this.</p>

<p>dig aaaa ipv6.watson-wilson.ca</p>

<p>; &lt;&lt;&gt;&gt; DiG 9.7.3 &lt;&lt;&gt;&gt; aaaa ipv6.watson-wilson.ca
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 36878
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</p>

<p>;; QUESTION SECTION:
;ipv6.watson-wilson.ca.    IN AAAA</p>

<p>;; ANSWER SECTION:
ipv6.watson-wilson.ca.  10725 IN AAAA  2604:8800:100:111::2</p>

<p>;; Query time: 8 msec
;; SERVER: 199.19.175.71#53(199.19.175.71)
;; WHEN: Sun Dec 18 13:16:00 2011
;; MSG SIZE  rcvd: 67</p>

<p>It’s worth noting that since IPV6 address are so long lazy IT staff are not going to be able to forsake DNS and memorize IPV4 addresses as they have done the in past. A working DNS service is paramount for successful use of IPV6.</p>

<p>Next was to configure a virtual host in Apache.</p>

<h1>Listen [2604:8800:100:111::2]:80</h1>

<p><virtualhost *:80></virtualhost></p>

<pre><code>ServerName ipv6.watson-wilson.ca
DocumentRoot &quot;/var/www/ipv6/&quot;
ErrorLog /var/log/apache2/error_log
CustomLog /var/log/apache2/access_log combined
</code></pre>

<h1>redacted</h1>

<p></p>

<p>If you have an IPV6 tunnel you can visit it here. If not, you can visit it via ipv6proxy.net here</p>

<p>In the next part I’ll show a dual stack host that has native IPV4 and IPV6 connectivity.</p>



            </article>
            <article>
                <header>
                    <h1><a href="/blog/2011/12/06/ipv6-migration-part1/">IPv6 Migration part 1</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/ipv6/" rel="tag">ipv6</a>
                        <a href="/blog/tag/networking/" rel="tag">networking</a>
                    </p>

                    <aside>
                        <p><time datetime="2011-12-06">
                            Posted on 2011-12-06
                        </time>
                        </p>
                    </aside>

                </header>

                <p>The first step in my exploration of IPV6 was to get an IPV6 address via an IPV4 to IPV6 tunnel. A little research lead me to the fine folks at SixXS.</p>

<p>My ISP does not offer IPV6 addresses at this time. Even if it did I did not want to go all the way down the rabbit hole at this time. Instead I chose the tunnel route. SixXS allows you to set a tunnel from your host to their servers. It is similar to a VPN connection. Your presence at the SixXS end of the tunnel is an IPV6 address. Their website explains in good detail how to get ready for, apply for and set up this tunnel.</p>

<p>UPDATE. I have since moved from SixXS to Hurricane Electric. See See here for more details.</p>

<p>The first preparation was to ready my firewall. This caused me some grief. Typically I&#39;ve configured my firewall by hand but these additional requirements added complexity which made me doubt the firewall&#39;s integrity. In an effort to simplify I built all new firewall rules using Firewall Builder. After the initial learning curve I was off to the races. The relevant rules are:</p>

<p>UPDATE. I have since chaned my firewall software. I now use Shorewall.</p>

<pre><code>Allow protocol 41 between my IPV4 IP and tunnel target at SixXS.
Allow ICMPv6 between my IPV6 IP and the Internet.
</code></pre>

<p>More paranoid folks try to block a lot of ICMP traffic. ICMP traffic has a purpose and blocking can cause trouble as it did for me. In this instance SixXS monitors the tunnel using ICMPv6 traffic.</p>

<p>After applying for a tunnel SixXS send me the details. My test host runs Debian. I had to configure an interface for the tunnel:</p>

<p>iface sixxs inet6 v4tunnel
    address 2604:8800:100:111::2
    netmask 64
    endpoint 38.229.76.3
    ttl 64
    up ip link set mtu 1280 dev sixxs
    up ip route add default via 2604:8800:100:111::1 dev sixxs</p>

<p>My IPV6 address is 2604:8800:100:111::2. The endpoint is the target at SixXS to create the tunnel. Then I bring the interface up.</p>

<p>sixxs     Link encap:IPv6-in-IPv4 <br>
          inet6 addr: fe80::c713:ab18/64 Scope:Link
          inet6 addr: 2604:8800:100:111::2/64 Scope:Global
          inet6 addr: fe80::a00:1/64 Scope:Link
          inet6 addr: fe80::c0a8:1/64 Scope:Link
          UP POINTOPOINT RUNNING NOARP  MTU:1280  Metric:1
          RX packets:5134 errors:0 dropped:0 overruns:0 frame:0
          TX packets:4398 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:4788682 (4.5 MiB)  TX bytes:623868 (609.2 KiB)</p>

<p>And it works:</p>

<p>ping6 -nc 4 ipv6.google.com</p>

<p>PING ipv6.google.com(2607:f8b0:4001:c01::93) 56 data bytes
64 bytes from 2607:f8b0:4001:c01::93: icmp_seq=1 ttl=56 time=41.1 ms
64 bytes from 2607:f8b0:4001:c01::93: icmp_seq=2 ttl=56 time=41.3 ms
64 bytes from 2607:f8b0:4001:c01::93: icmp_seq=3 ttl=56 time=42.3 ms
64 bytes from 2607:f8b0:4001:c01::93: icmp_seq=4 ttl=56 time=41.4 ms</p>

<p>--- ipv6.google.com ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3004ms
rtt min/avg/max/mdev = 41.173/41.576/42.351/0.456 ms</p>

<p>Be aware that firewall tools, like Iptables, require separate rules for IPV6 traffic. A normal IPV4 firewall may allow all IPV6 traffic or block it.</p>

<p>Next time I&#39;ll look at enabling a service using an IPV6 address.</p>



            </article>
            <article>
                <header>
                    <h1><a href="/blog/2011/03/08/linux-network-cheatsheet/">Linux networking cheatsheet</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/linux/" rel="tag">linux</a>
                        <a href="/blog/tag/networking/" rel="tag">networking</a>
                        <a href="/blog/tag/cheatsheet/" rel="tag">cheatsheet</a>
                    </p>

                    <aside>
                        <p><time datetime="2011-03-08">
                            Posted on 2011-03-08
                        </time>
                        </p>
                    </aside>

                </header>

                <p>Network calculation Show network info  ipcalc 10.0.0.0/24
ipcalc 10.0.0.0/255.255.255.0
Segment network into 2 50 node subnets    ipcalc 10.0.0.0/24 -s 50 50</p>

<p>Net-tools versus Iptroute2 List interfaces   ip addr list
ifconfig -a
ip addr list eth0
ifconfig eth0
Link status    ip link list
ifconfig -a
ip link list eth0
ifconfig eth0
Route table    ip route
netstat -rn
Adding routes  ip route add default via 10.0.0.1
Add/delete IP addresses    ip addr add 10.0.0.2/24 dev eth0
ifconfig eth0 10.0.0.2 netmask 255.255.255.0
ip addr del 10.0.0.2/24 dev eth0
ifconfig eth0 del 10.0.0.2
Linux Ethernet bonding</p>

<h1>Loading module:</h1>

<h1>for Red Hat AS4, may work with other 2.6 Linuxes.</h1>

<p>install bond0 /sbin/modprobe bonding -o bond0 mode=0 miimon=100</p>

<h1>for Red Hat AS3, may work with other 2.4 Linuxes.</h1>

<p>alias bond0 bonding
options bond0 -o bonding mode=0 miimon=100</p>

<h1>For Redhat distributions</h1>

<h1>ifcfg-ethx</h1>

<p>DEVICE=ethx
USERCTL=no
ONBOOT=yes
MASTER=bond0
SLAVE=yes
BOOTPROTO=none</p>

<h1>ifcfg-bond0</h1>

<p>DEVICE=bond0
USERCTL=no
ONBOOT=yes
IPADDR=172.16.48.66
NETMASK=255.255.255.0
GATEWAY=172.16.48.1</p>

<p>Click for more Ethernet bonding information.
OSI model diagram
osi-model.gif</p>



            </article>
        </main>

        <ul class="pager">
            <li class="prev">
                <a class="button disabled" href="" rel="next">
                    ← Older
                </a>
            </li>
            <li class="next">
                <a class="button button-primary" href="/blog/tag/networking" rel="prev">
                    Newer →
                </a>
            </li>
        </ul>

    </div>

    <div class="three columns sidebar">
        
        <h1>Tags</h1>
        <ul class="list-inline">
            <li><a href="/blog/tag/apt/">apt</a></li>
            <li><a href="/blog/tag/backup/">backup</a></li>
            <li><a href="/blog/tag/cfengine/">cfengine</a></li>
            <li><a href="/blog/tag/cfengine-cookbook/">cfengine cookbook</a></li>
            <li><a href="/blog/tag/cheatsheet/">cheatsheet</a></li>
            <li><a href="/blog/tag/cli/">cli</a></li>
            <li><a href="/blog/tag/cluster/">cluster</a></li>
            <li><a href="/blog/tag/configuration-management/">configuration management</a></li>
            <li><a href="/blog/tag/cron/">cron</a></li>
            <li><a href="/blog/tag/debian/">debian</a></li>
            <li><a href="/blog/tag/dns/">dns</a></li>
            <li><a href="/blog/tag/dr/">dr</a></li>
            <li><a href="/blog/tag/heartbeat/">heartbeat</a></li>
            <li><a href="/blog/tag/high-availability/">high availability</a></li>
            <li><a href="/blog/tag/infosec/">infosec</a></li>
            <li><a href="/blog/tag/ipv6/">ipv6</a></li>
            <li><a href="/blog/tag/iscsi/">iscsi</a></li>
            <li><a href="/blog/tag/kvm/">kvm</a></li>
            <li><a href="/blog/tag/linux/">linux</a></li>
            <li><a href="/blog/tag/monitoring/">monitoring</a></li>
            <li><a href="/blog/tag/multipathd/">multipathd</a></li>
            <li><a href="/blog/tag/networking/">networking</a></li>
            <li><a href="/blog/tag/opensource/">opensource</a></li>
            <li><a href="/blog/tag/oracle/">oracle</a></li>
            <li><a href="/blog/tag/posix/">posix</a></li>
            <li><a href="/blog/tag/red-hat/">red hat</a></li>
            <li><a href="/blog/tag/regex/">regex</a></li>
            <li><a href="/blog/tag/rhev/">rhev</a></li>
            <li><a href="/blog/tag/san/">san</a></li>
            <li><a href="/blog/tag/shell/">shell</a></li>
            <li><a href="/blog/tag/solaris/">solaris</a></li>
            <li><a href="/blog/tag/ssh/">ssh</a></li>
            <li><a href="/blog/tag/subversion/">subversion</a></li>
            <li><a href="/blog/tag/sun/">sun</a></li>
            <li><a href="/blog/tag/support/">support</a></li>
            <li><a href="/blog/tag/svn/">svn</a></li>
            <li><a href="/blog/tag/sysadmin/">sysadmin</a></li>
            <li><a href="/blog/tag/vitualization/">vitualization</a></li>
        </ul>
        <h1>Feeds</h1>
        <ul class="list-inline">
            <li>
                <a href="/blog/tag/networking.atom" rel="alternate" type="application/atom+xml">
                    Atom
                </a>
            </li>
            <li>
                <a href="/blog/tag/networking.rss" rel="alternate" type="application/rss+xml">
                    RSS
                </a>
            </li>
        </ul>
    </div>

</div>


        </div>
        <footer>
            
            <div class="container tagline">
                <a href="http://preaction.github.io/Statocles">Made with Statocles</a><br>
                <a href="http://www.perl.org">Powered by Perl</a>
            </div>
        </footer>
    </body>
</html>
